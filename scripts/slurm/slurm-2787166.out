[nltk_data] Downloading package punkt to /gpfs/data/fs72332/fkovacev/d
[nltk_data]     ata/core/grapher/output/../lib/punkt...
[nltk_data] Downloading package punkt to /gpfs/data/fs72332/fkovacev/d
[nltk_data]     ata/core/grapher/output/../lib/punkt...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
2024-02-16 17:20:17 root INFO: Load training data into GraphDataset.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
2024-02-16 17:20:18 root INFO: Load training data into GraphDataset.
2024-02-16 17:20:19 root INFO: Load validation data (dev) into GraphDataset.
[nltk_data] Downloading package punkt to /gpfs/data/fs72332/fkovacev/d
[nltk_data]     ata/core/grapher/output/../lib/punkt...
[nltk_data] Downloading package punkt to /gpfs/data/fs72332/fkovacev/d
[nltk_data]     ata/core/grapher/output/../lib/punkt...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
2024-02-16 17:20:19 root INFO: Process ID: 3259069
; Parent ID: 369604
2024-02-16 17:20:19 root INFO: Process ID: 3259223
; Parent ID: 369604
2024-02-16 17:20:19 root INFO: Process ID: 1126287
; Parent ID: 369604
2024-02-16 17:20:19 root INFO: Process ID: 1126288
; Parent ID: 369604
2024-02-16 17:20:19 root INFO: Process ID: 1322896
; Parent ID: 369604
2024-02-16 17:20:19 root INFO: Process ID: 1322895
; Parent ID: 369604
2024-02-16 17:20:19 root INFO: Process ID: 369611
; Parent ID: 369604
2024-02-16 17:20:19 root INFO: Created new directory: /gpfs/data/fs72332/fkovacev/data/core/grapher/output/webnlg_model_variant=class/2024-02-16 17:20:19 with three sub directories
2024-02-16 17:20:19 root INFO: Load validation data (dev) into GraphDataset.
2024-02-16 17:20:19 torch.distributed.nn.jit.instantiator INFO: Created a temporary directory at /tmp/tmpf2bqxdgz
2024-02-16 17:20:19 torch.distributed.nn.jit.instantiator INFO: Writing /tmp/tmpf2bqxdgz/_remote_module_non_scriptable.py
2024-02-16 17:20:19 root INFO: Process ID: 3259069
; Parent ID: 369604
2024-02-16 17:20:19 root INFO: Process ID: 3259223
; Parent ID: 369604
2024-02-16 17:20:19 root INFO: Process ID: 1126287
; Parent ID: 369604
2024-02-16 17:20:19 root INFO: Process ID: 1126288
; Parent ID: 369604
2024-02-16 17:20:19 root INFO: Process ID: 1322896
; Parent ID: 369604
2024-02-16 17:20:19 root INFO: Process ID: 1322895
; Parent ID: 369604
2024-02-16 17:20:19 root INFO: Process ID: 369611
; Parent ID: 369604
2024-02-16 17:20:19 root INFO: Process ID: 369610
; Parent ID: 369604
2024-02-16 17:20:19 root INFO: Created new directory: /gpfs/data/fs72332/fkovacev/data/core/grapher/output/webnlg_model_variant=class/2024-02-16 17:20:19 with three sub directories
2024-02-16 17:20:19 torch.distributed.nn.jit.instantiator INFO: Created a temporary directory at /tmp/tmp501o9vli
2024-02-16 17:20:19 torch.distributed.nn.jit.instantiator INFO: Writing /tmp/tmp501o9vli/_remote_module_non_scriptable.py
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
2024-02-16 17:20:19 root INFO: Load training data into GraphDataset.
2024-02-16 17:20:19 root INFO: Load training data into GraphDataset.
2024-02-16 17:20:20 root INFO: Load validation data (dev) into GraphDataset.
2024-02-16 17:20:20 root INFO: Load validation data (dev) into GraphDataset.
2024-02-16 17:20:20 root INFO: Process ID: 3259069
; Parent ID: 963020
2024-02-16 17:20:20 root INFO: Process ID: 3259069
; Parent ID: 963020
2024-02-16 17:20:20 root INFO: Process ID: 3259223
; Parent ID: 963020
2024-02-16 17:20:20 root INFO: Process ID: 3259223
; Parent ID: 963020
2024-02-16 17:20:20 root INFO: Process ID: 1126287
; Parent ID: 963020
2024-02-16 17:20:20 root INFO: Process ID: 1126287
; Parent ID: 963020
2024-02-16 17:20:20 root INFO: Process ID: 1126288
; Parent ID: 963020
2024-02-16 17:20:20 root INFO: Process ID: 1322896
; Parent ID: 963020
2024-02-16 17:20:20 root INFO: Process ID: 1126288
; Parent ID: 963020
2024-02-16 17:20:20 root INFO: Process ID: 1322896
; Parent ID: 963020
2024-02-16 17:20:20 root INFO: Process ID: 1322895
; Parent ID: 963020
2024-02-16 17:20:20 root INFO: Process ID: 369611
; Parent ID: 963020
2024-02-16 17:20:20 root INFO: Process ID: 1322895
; Parent ID: 963020
2024-02-16 17:20:20 root INFO: Process ID: 369610
; Parent ID: 963020
2024-02-16 17:20:20 root INFO: Process ID: 963026
; Parent ID: 963020
2024-02-16 17:20:20 root INFO: Process ID: 369611
; Parent ID: 963020
2024-02-16 17:20:20 root INFO: Process ID: 963027
; Parent ID: 963020
2024-02-16 17:20:20 root INFO: Process ID: 369610
; Parent ID: 963020
2024-02-16 17:20:20 root INFO: Process ID: 963026
; Parent ID: 963020
2024-02-16 17:20:20 root INFO: Process ID: 963027
; Parent ID: 963020
2024-02-16 17:20:21 root INFO: Created new directory: /gpfs/data/fs72332/fkovacev/data/core/grapher/output/webnlg_model_variant=class/2024-02-16 17:20:20 with three sub directories
2024-02-16 17:20:21 root INFO: Created new directory: /gpfs/data/fs72332/fkovacev/data/core/grapher/output/webnlg_model_variant=class/2024-02-16 17:20:20 with three sub directories
2024-02-16 17:20:21 torch.distributed.nn.jit.instantiator INFO: Created a temporary directory at /tmp/tmptrevl054
2024-02-16 17:20:21 torch.distributed.nn.jit.instantiator INFO: Created a temporary directory at /tmp/tmp27qjhu8b
2024-02-16 17:20:21 torch.distributed.nn.jit.instantiator INFO: Writing /tmp/tmp27qjhu8b/_remote_module_non_scriptable.py
2024-02-16 17:20:21 torch.distributed.nn.jit.instantiator INFO: Writing /tmp/tmptrevl054/_remote_module_non_scriptable.py
2024-02-16 17:20:24 root INFO: NVIDIA A40
2024-02-16 17:20:24 root INFO: NVIDIA A40
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
2024-02-16 17:20:25 root INFO: Starting new training in location: /gpfs/data/fs72332/fkovacev/data/core/grapher/output/webnlg_model_variant=class/2024-02-16 17:20:19
`Trainer(limit_train_batches=1.0)` was configured so 100% of the batches per epoch will be used..
`Trainer(limit_val_batches=1.0)` was configured so 100% of the batches will be used..
`Trainer(limit_test_batches=1.0)` was configured so 100% of the batches will be used..
2024-02-16 17:20:25 root INFO: Starting new training in location: /gpfs/data/fs72332/fkovacev/data/core/grapher/output/webnlg_model_variant=class/2024-02-16 17:20:19
Initializing distributed: GLOBAL_RANK: 1, MEMBER: 2/4
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/4
2024-02-16 17:20:25 torch.distributed.distributed_c10d INFO: Added key: store_based_barrier_key:1 to store for rank: 1
2024-02-16 17:20:26 root INFO: NVIDIA A40
2024-02-16 17:20:26 root INFO: NVIDIA A40
2024-02-16 17:20:26 root INFO: Starting new training in location: /gpfs/data/fs72332/fkovacev/data/core/grapher/output/webnlg_model_variant=class/2024-02-16 17:20:20
2024-02-16 17:20:26 root INFO: Starting new training in location: /gpfs/data/fs72332/fkovacev/data/core/grapher/output/webnlg_model_variant=class/2024-02-16 17:20:20
Initializing distributed: GLOBAL_RANK: 3, MEMBER: 4/4
2024-02-16 17:20:27 torch.distributed.distributed_c10d INFO: Added key: store_based_barrier_key:1 to store for rank: 3
Initializing distributed: GLOBAL_RANK: 2, MEMBER: 3/4
2024-02-16 17:20:27 torch.distributed.distributed_c10d INFO: Added key: store_based_barrier_key:1 to store for rank: 2
2024-02-16 17:20:27 torch.distributed.distributed_c10d INFO: Added key: store_based_barrier_key:1 to store for rank: 0
2024-02-16 17:20:27 torch.distributed.distributed_c10d INFO: Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 4 processes
----------------------------------------------------------------------------------------------------

2024-02-16 17:20:27 torch.distributed.distributed_c10d INFO: Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
2024-02-16 17:20:27 torch.distributed.distributed_c10d INFO: Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
2024-02-16 17:20:27 torch.distributed.distributed_c10d INFO: Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
2024-02-16 17:20:30 root INFO: Load training data into GraphDataset.
2024-02-16 17:20:30 root INFO: Load training data into GraphDataset.
2024-02-16 17:20:29 root INFO: Load training data into GraphDataset.
2024-02-16 17:20:29 root INFO: Load training data into GraphDataset.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1]
┏━━━┳━━━━━━━┳━━━━━━━━━┳━━━━━━━━┓
┃   ┃ Name  ┃ Type    ┃ Params ┃
┡━━━╇━━━━━━━╇━━━━━━━━━╇━━━━━━━━┩
│ 0 │ model │ Grapher │  738 M │
└───┴───────┴─────────┴────────┘
Trainable params: 738 M                                                         
Non-trainable params: 0                                                         
Total params: 738 M                                                             
Total estimated model params size (MB): 3.0 K                                   
SLURM auto-requeueing enabled. Setting signal handlers.
SLURM auto-requeueing enabled. Setting signal handlers.
SLURM auto-requeueing enabled. Setting signal handlers.
SLURM auto-requeueing enabled. Setting signal handlers.
2024-02-16 17:20:41 torch.nn.parallel.distributed INFO: Reducer buckets have been rebuilt in this iteration.
2024-02-16 17:20:41 torch.nn.parallel.distributed INFO: Reducer buckets have been rebuilt in this iteration.
2024-02-16 17:20:41 torch.nn.parallel.distributed INFO: Reducer buckets have been rebuilt in this iteration.
2024-02-16 17:20:41 torch.nn.parallel.distributed INFO: Reducer buckets have been rebuilt in this iteration.
2024-02-16 17:29:22 root INFO: Iteration: 45; Rank: 0
2024-02-16 17:29:25 root INFO: Iteration: 45; Rank: 2
2024-02-16 17:29:26 root INFO: Iteration: 45; Rank: 3
2024-02-16 17:29:27 root INFO: Iteration: 45; Rank: 1
2024-02-16 17:29:48 root INFO: Validation scores: Precision: 7.571168988491823e-05; Recall: 0.00010094891984655763; F1: 8.65276455827637e-05
2024-02-16 17:29:48 root INFO: Validation epoch ended
2024-02-16 17:29:51 root INFO: Validation scores: Precision: 7.562008469449486e-05; Recall: 0.00010082677959265981; F1: 8.642295393656557e-05
2024-02-16 17:29:51 root INFO: Validation epoch ended
2024-02-16 17:29:52 root INFO: Validation scores: Precision: 7.559721802237678e-05; Recall: 0.00010079629069650237; F1: 8.639682059700204e-05
2024-02-16 17:29:52 root INFO: Validation epoch ended
2024-02-16 17:29:52 root INFO: Validation scores: Precision: 0.0; Recall: 0.0; F1: 0
2024-02-16 17:29:52 root INFO: Validation epoch ended
creating reference xml  file : [/gpfs/data/fs72332/fkovacev/data/core/grapher/output/webnlg_model_variant=class/2024-02-16 17:20:19/valid/ref_45_1.xml]
creating hypothesis xml file : [/gpfs/data/fs72332/fkovacev/data/core/grapher/output/webnlg_model_variant=class/2024-02-16 17:20:19/valid/hyp_45_1.xml]
creating reference xml  file : [/gpfs/data/fs72332/fkovacev/data/core/grapher/output/webnlg_model_variant=class/2024-02-16 17:20:20/valid/ref_45_3.xml]
creating hypothesis xml file : [/gpfs/data/fs72332/fkovacev/data/core/grapher/output/webnlg_model_variant=class/2024-02-16 17:20:20/valid/hyp_45_3.xml]
creating reference xml  file : [/gpfs/data/fs72332/fkovacev/data/core/grapher/output/webnlg_model_variant=class/2024-02-16 17:20:19/valid/ref_45_0.xml]
creating hypothesis xml file : [/gpfs/data/fs72332/fkovacev/data/core/grapher/output/webnlg_model_variant=class/2024-02-16 17:20:19/valid/hyp_45_0.xml]
creating reference xml  file : [/gpfs/data/fs72332/fkovacev/data/core/grapher/output/webnlg_model_variant=class/2024-02-16 17:20:20/valid/ref_45_2.xml]
creating hypothesis xml file : [/gpfs/data/fs72332/fkovacev/data/core/grapher/output/webnlg_model_variant=class/2024-02-16 17:20:20/valid/hyp_45_2.xml]
2024-02-16 17:38:45 root INFO: Iteration: 90; Rank: 0
2024-02-16 17:38:47 root INFO: Iteration: 90; Rank: 3
2024-02-16 17:38:47 root INFO: Iteration: 90; Rank: 2
2024-02-16 17:38:52 root INFO: Iteration: 90; Rank: 1
2024-02-16 17:39:35 root INFO: Validation scores: Precision: 7.571168988491823e-05; Recall: 0.00010094891984655763; F1: 8.65276455827637e-05
2024-02-16 17:39:35 root INFO: Validation epoch ended
2024-02-16 17:39:39 root INFO: Validation scores: Precision: 7.559721802237678e-05; Recall: 0.00010079629069650237; F1: 8.639682059700204e-05
2024-02-16 17:39:39 root INFO: Validation epoch ended
2024-02-16 17:39:39 root INFO: Validation scores: Precision: 7.562008469449486e-05; Recall: 0.00010082677959265981; F1: 8.642295393656557e-05
2024-02-16 17:39:39 root INFO: Validation epoch ended
2024-02-16 17:39:42 root INFO: Validation scores: Precision: 0.0; Recall: 0.0; F1: 0
2024-02-16 17:39:42 root INFO: Validation epoch ended
creating reference xml  file : [/gpfs/data/fs72332/fkovacev/data/core/grapher/output/webnlg_model_variant=class/2024-02-16 17:20:19/valid/ref_90_1.xml]
creating hypothesis xml file : [/gpfs/data/fs72332/fkovacev/data/core/grapher/output/webnlg_model_variant=class/2024-02-16 17:20:19/valid/hyp_90_1.xml]
creating reference xml  file : [/gpfs/data/fs72332/fkovacev/data/core/grapher/output/webnlg_model_variant=class/2024-02-16 17:20:20/valid/ref_90_2.xml]
creating hypothesis xml file : [/gpfs/data/fs72332/fkovacev/data/core/grapher/output/webnlg_model_variant=class/2024-02-16 17:20:20/valid/hyp_90_2.xml]
creating reference xml  file : [/gpfs/data/fs72332/fkovacev/data/core/grapher/output/webnlg_model_variant=class/2024-02-16 17:20:20/valid/ref_90_3.xml]
creating hypothesis xml file : [/gpfs/data/fs72332/fkovacev/data/core/grapher/output/webnlg_model_variant=class/2024-02-16 17:20:20/valid/hyp_90_3.xml]
creating reference xml  file : [/gpfs/data/fs72332/fkovacev/data/core/grapher/output/webnlg_model_variant=class/2024-02-16 17:20:19/valid/ref_90_0.xml]
creating hypothesis xml file : [/gpfs/data/fs72332/fkovacev/data/core/grapher/output/webnlg_model_variant=class/2024-02-16 17:20:19/valid/hyp_90_0.xml]
2024-02-16 17:48:33 root INFO: Iteration: 135; Rank: 0
2024-02-16 17:48:37 root INFO: Iteration: 135; Rank: 2
2024-02-16 17:48:37 root INFO: Iteration: 135; Rank: 3
2024-02-16 17:48:42 root INFO: Iteration: 135; Rank: 1
2024-02-16 17:49:49 root INFO: Validation scores: Precision: 7.571168988491823e-05; Recall: 0.00010094891984655763; F1: 8.65276455827637e-05
2024-02-16 17:49:49 root INFO: Validation epoch ended
2024-02-16 17:49:54 root INFO: Validation scores: Precision: 7.559721802237678e-05; Recall: 0.00010079629069650237; F1: 8.639682059700204e-05
2024-02-16 17:49:54 root INFO: Validation epoch ended
2024-02-16 17:49:55 root INFO: Validation scores: Precision: 7.562008469449486e-05; Recall: 0.00010082677959265981; F1: 8.642295393656557e-05
2024-02-16 17:49:55 root INFO: Validation epoch ended
2024-02-16 17:49:57 root INFO: Validation scores: Precision: 0.0; Recall: 0.0; F1: 0
2024-02-16 17:49:57 root INFO: Validation epoch ended
creating reference xml  file : [/gpfs/data/fs72332/fkovacev/data/core/grapher/output/webnlg_model_variant=class/2024-02-16 17:20:19/valid/ref_135_1.xml]
creating hypothesis xml file : [/gpfs/data/fs72332/fkovacev/data/core/grapher/output/webnlg_model_variant=class/2024-02-16 17:20:19/valid/hyp_135_1.xml]
creating reference xml  file : [/gpfs/data/fs72332/fkovacev/data/core/grapher/output/webnlg_model_variant=class/2024-02-16 17:20:20/valid/ref_135_2.xml]
creating hypothesis xml file : [/gpfs/data/fs72332/fkovacev/data/core/grapher/output/webnlg_model_variant=class/2024-02-16 17:20:20/valid/hyp_135_2.xml]
creating reference xml  file : [/gpfs/data/fs72332/fkovacev/data/core/grapher/output/webnlg_model_variant=class/2024-02-16 17:20:19/valid/ref_135_0.xml]
creating hypothesis xml file : [/gpfs/data/fs72332/fkovacev/data/core/grapher/output/webnlg_model_variant=class/2024-02-16 17:20:19/valid/hyp_135_0.xml]
creating reference xml  file : [/gpfs/data/fs72332/fkovacev/data/core/grapher/output/webnlg_model_variant=class/2024-02-16 17:20:20/valid/ref_135_3.xml]
creating hypothesis xml file : [/gpfs/data/fs72332/fkovacev/data/core/grapher/output/webnlg_model_variant=class/2024-02-16 17:20:20/valid/hyp_135_3.xml]
2024-02-16 17:58:59 root INFO: Iteration: 180; Rank: 3
2024-02-16 17:58:59 root INFO: Iteration: 180; Rank: 0
2024-02-16 17:58:59 root INFO: Iteration: 180; Rank: 2
2024-02-16 17:59:01 root INFO: Iteration: 180; Rank: 1
2024-02-16 18:00:42 root INFO: Validation scores: Precision: 7.571168988491823e-05; Recall: 0.00010094891984655763; F1: 8.65276455827637e-05
2024-02-16 18:00:42 root INFO: Validation epoch ended
2024-02-16 18:00:43 root INFO: Validation scores: Precision: 7.559721802237678e-05; Recall: 0.00010079629069650237; F1: 8.639682059700204e-05
2024-02-16 18:00:43 root INFO: Validation epoch ended
2024-02-16 18:00:43 root INFO: Validation scores: Precision: 0.0; Recall: 0.0; F1: 0
2024-02-16 18:00:43 root INFO: Validation epoch ended
2024-02-16 18:00:43 root INFO: Validation scores: Precision: 7.562008469449486e-05; Recall: 0.00010082677959265981; F1: 8.642295393656557e-05
2024-02-16 18:00:43 root INFO: Validation epoch ended
creating reference xml  file : [/gpfs/data/fs72332/fkovacev/data/core/grapher/output/webnlg_model_variant=class/2024-02-16 17:20:20/valid/ref_180_2.xml]
creating hypothesis xml file : [/gpfs/data/fs72332/fkovacev/data/core/grapher/output/webnlg_model_variant=class/2024-02-16 17:20:20/valid/hyp_180_2.xml]
creating reference xml  file : [/gpfs/data/fs72332/fkovacev/data/core/grapher/output/webnlg_model_variant=class/2024-02-16 17:20:19/valid/ref_180_1.xml]
creating hypothesis xml file : [/gpfs/data/fs72332/fkovacev/data/core/grapher/output/webnlg_model_variant=class/2024-02-16 17:20:19/valid/hyp_180_1.xml]
creating reference xml  file : [/gpfs/data/fs72332/fkovacev/data/core/grapher/output/webnlg_model_variant=class/2024-02-16 17:20:19/valid/ref_180_0.xml]
creating hypothesis xml file : [/gpfs/data/fs72332/fkovacev/data/core/grapher/output/webnlg_model_variant=class/2024-02-16 17:20:19/valid/hyp_180_0.xml]
creating reference xml  file : [/gpfs/data/fs72332/fkovacev/data/core/grapher/output/webnlg_model_variant=class/2024-02-16 17:20:20/valid/ref_180_3.xml]
creating hypothesis xml file : [/gpfs/data/fs72332/fkovacev/data/core/grapher/output/webnlg_model_variant=class/2024-02-16 17:20:20/valid/hyp_180_3.xml]
Epoch 3/99 ━━━━━━━━━━━━━━━━━━━━━━ 443/443 0:05:08 • 0:00:00 1.31it/s v_num: 0:19